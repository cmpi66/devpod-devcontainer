{
  "build": { "context": "..", "dockerfile": "Dockerfile" },
  "remoteUser": "root",

  "containerEnv": {
    "SHELL": "/usr/bin/zsh",
    "DEVCONTAINER": "1",

    "GITHUB_TOKEN": "${localEnv:GITHUB_TOKEN}",

    "MISE_DATA_DIR": "/home/root/.local/share/mise",
    "MISE_CACHE_DIR": "/home/root/.cache/mise",
    "MISE_STATE_DIR": "/home/root/.local/state/mise",

    "PIP_CACHE_DIR": "/home/root/.cache/pip",

    "GOPATH": "/go",
    "GOMODCACHE": "/go/pkg/mod",
    "GOCACHE": "/home/root/.cache/go-build"
  },

  "mounts": [
    "source=devpod-mise-data,target=/home/root/.local/share/mise,type=volume",
    "source=devpod-mise-cache,target=/home/root/.cache/mise,type=volume",
    "source=devpod-mise-state,target=/home/root/.local/state/mise,type=volume",

    "source=devpod-pip-cache,target=/home/root/.cache/pip,type=volume",

    "source=devpod-go-path,target=/go,type=volume",
    "source=devpod-go-build-cache,target=/home/root/.cache/go-build,type=volume"
  ],

  "features": {
    "ghcr.io/devcontainers/features/common-utils:2": {
      "configureZshAsDefaultShell": true
    },
    "ghcr.io/w3cj/devcontainer-features/firewall:latest": {}
  },

  "postCreateCommand": "/usr/local/bin/devcontainer-setup"
}

